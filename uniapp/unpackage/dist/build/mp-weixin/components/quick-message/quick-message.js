"use strict";const t=require("../../common/vendor.js"),s={data:()=>({msgList:[],time:3e3,id:101,elHeight:[],messageAniStyle:null,closeInfo:{},direction:"top",safeHeight:0,count:{start:0,end:0},color:{success:"#67c23a",default:"#1989fa",warning:"#e6a23c",error:"#f56c6c"},icon:{success:"success",default:"info",warning:"warn",error:"clear"},directionStyle:{top:{class:"show-message",style:{top:"5%"}},center:{class:"show-message-reverse",style:{top:"inherit",bottom:"50%"}},bottom:{class:"show-message-reverse",style:{top:"inherit",bottom:"10%"}}}}),mounted(){let s=this;t.index.getSystemInfo({success:function(t){s.safeHeight=t.safeArea.top+"px"}})},methods:{show(t){t.id=this.createId(),this.direction=t.direction||"top",t.customStyle=t.customStyle||{};let s=t.customStyle.fontSize?Number(t.customStyle.fontSize.toString().replace(/\D/g,"")):32;t.type=t.type?t.type:"default";let e=t.iconColor?t.iconColor:t.customStyle.color?t.customStyle.color:this.color[t.type];t.class=this.directionStyle[this.direction].class,t.icon=!1===t.icon?"":!0!==t.icon&&t.icon?t.icon:this.icon[t.type],t.iconColor=e,t.textColor=t.customStyle.color?t.customStyle.color:"default"===t.type?"#222222":this.color[t.type],t.textSize=s+"rpx",!t.iconSize&&(t.iconSize=s/2),"top"!==this.direction&&this.msgList.length&&(this.msgList[0].class=""),setTimeout((()=>{"top"===this.direction?this.msgList.push(t):this.msgList.unshift(t),this.closeInfo[t.id]=t,this.closeMessage(t)}),50)},getClass(s){const e=t.index.createSelectorQuery().in(this);return new Promise(((t,i)=>{e.select("."+s).boundingClientRect((s=>{t(s)})).exec()}))},closeMessage(t){let s=isNaN(Number(t.time))?this.time:Number(t.time);!1!==t.time&&setTimeout((async()=>{let t=[],s=[];this.msgList.forEach(((e,i)=>{!1===e.time?s.push(e):t.push(e)})),this.msgList=t.concat(s);let e=this.msgList.length-1-this.count.start;this.msgList=this.msgList.map(((t,s)=>("top"===this.direction?s<=this.count.start&&(t.class="close-message"):s>=e&&(t.class="close-message"),t))),this.msgList.push(),this.count.start++;let i=null;if("top"===this.direction)i=await this.getClass("classList"+this.count.start);else{let t=this.msgList.length;i=await this.getClass("classList"+t)}this.elHeight.push(i?i.height:41);let o=this.elHeight.reduce((function(t,s){return Number((t+s).toFixed(2))})),c="top"===this.direction?-o:o;this.messageAniStyle={transform:"translate(-50%, "+c+"px)",transition:"all 0.4s"},setTimeout((()=>{this.count.end++,this.count.start===this.count.end&&(this.messageAniStyle={},this.msgList=this.msgList.map(((t,s)=>(t.class="",t))),this.msgList.length,"top"===this.direction?(this.msgList.splice(0,this.count.start),this.elHeight.splice(0,this.count.start)):(this.msgList.splice(-this.count.start,this.count.start),this.elHeight.splice(-this.count.start,this.count.start)),this.count.start=0,this.count.end=0)}),300)}),s)},createId(){return++this.id},close(t){if(t&&this.closeInfo[t]){let s=this.closeInfo[t];s.time=10,this.closeMessage(s)}}}};const e=t._export_sfc(s,[["render",function(s,e,i,o,c,n){return{a:t.f(c.msgList,((t,s,e)=>({a:s,b:t.mask}))),b:c.safeHeight+"px",c:t.f(c.msgList,((s,e,i)=>t.e({a:s.icon},s.icon?{b:s.icon,c:s.iconSize,d:s.iconColor?s.iconColor:""}:{},{e:t.t(s.msg),f:s.textSize,g:s.textColor,h:t.s(s.customStyle),i:t.n(s.type+"-message"),j:t.n(s.class?s.class:""),k:t.n("classList"+(e+1)),l:e}))),d:c.safeHeight+"px",e:t.s(c.messageAniStyle),f:t.s(c.directionStyle[c.direction].style)}}]]);wx.createComponent(e);
